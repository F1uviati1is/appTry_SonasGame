<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grammar Dash 3.0 - Poƒçitatelnost</title>
    
    <!-- React & Babel pro bƒõh v prohl√≠≈æeƒçi -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS pro stylov√°n√≠ -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide ikony -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        .animate-shake { animation: shake 0.2s ease-in-out 0s 2; }
        
        body {
            background-color: #020617;
            margin: 0;
            font-family: ui-sans-serif, system-ui, -apple-system, sans-serif;
        }

        /* Custom scrollbar pro hezƒç√≠ vzhled */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;

        // Pomocn√° komponenta pro ikony, proto≈æe Lucide v Reactu p≈ôes CDN funguje jinak
        const Icon = ({ name, size = 24, className = "" }) => {
            const [svg, setSvg] = useState("");
            useEffect(() => {
                if (window.lucide) {
                    const iconSvg = window.lucide.createIcons();
                }
            }, [name]);
            // Zjednodu≈°en√° verze pro demo - v ƒçist√©m HTML/React CDN prost≈ôed√≠
            // pou≈æ√≠v√°me i-tagy, kter√© Lucide nahrad√≠
            return <i data-lucide={name} style={{width: size, height: size}} className={className}></i>;
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('theory');
            const [score, setScore] = useState(0);
            
            const words = [
                { word: 'Apple', type: 'countable', icon: 'üçé' },
                { word: 'Water', type: 'uncountable', icon: 'üíß' },
                { word: 'Car', type: 'countable', icon: 'üöó' },
                { word: 'Money', type: 'uncountable', icon: 'üí∞' },
                { word: 'Bottle', type: 'countable', icon: 'üçº' },
                { word: 'Rice', type: 'uncountable', icon: 'üçö' },
                { word: 'Bread', type: 'uncountable', icon: 'üçû' },
                { word: 'Coffee', type: 'uncountable', icon: '‚òï' },
                { word: 'Book', type: 'countable', icon: 'üìñ' },
                { word: 'Furniture', type: 'uncountable', icon: 'üõãÔ∏è' },
                { word: 'Idea', type: 'countable', icon: 'üí°' },
                { word: 'Salt', type: 'uncountable', icon: 'üßÇ' },
                { word: 'Information', type: 'uncountable', icon: '‚ÑπÔ∏è' },
                { word: 'Student', type: 'countable', icon: 'üßë‚Äçüéì' },
                { word: 'Music', type: 'uncountable', icon: 'üéµ' },
            ];

            const quizQuestions = [
                {
                    sentence: "I don't have ___ money in my wallet.",
                    options: ['much', 'many'],
                    correct: 'much',
                    explanation: "Pen√≠ze (money) jsou v angliƒçtinƒõ nepoƒçitateln√©, proto v z√°poru pou≈æ√≠v√°me 'much'."
                },
                {
                    sentence: "How ___ apples do we need for the cake?",
                    options: ['much', 'many'],
                    correct: 'many',
                    explanation: "Jablka (apples) jsou poƒçitateln√° a v mno≈æn√©m ƒç√≠sle, proto pou≈æ√≠v√°me 'many'."
                },
                {
                    sentence: "Can I have ___ water, please?",
                    options: ['some', 'any'],
                    correct: 'some',
                    explanation: "V zdvo≈ôil√Ωch ≈æ√°dostech a nab√≠dk√°ch pou≈æ√≠v√°me 'some', i kdy≈æ jde o ot√°zku."
                },
                {
                    sentence: "There are only ___ students in the classroom today.",
                    options: ['a few', 'a little'],
                    correct: 'a few',
                    explanation: "Studenti jsou poƒçitateln√≠, pro mal√Ω poƒçet pou≈æ√≠v√°me 'a few'."
                },
                {
                    sentence: "I need ___ help with my homework.",
                    options: ['some', 'a'],
                    correct: 'some',
                    explanation: "Pomoc (help) je nepoƒçitateln√°, nem≈Ø≈æeme tedy pou≈æ√≠t neurƒçit√Ω ƒçlen 'a'."
                }
            ];

            // Game Logic
            const [gameState, setGameState] = useState('idle');
            const [lives, setLives] = useState(3);
            const [fallingWord, setFallingWord] = useState(null);
            const [fallingPos, setFallingPos] = useState(0);
            const [speed, setSpeed] = useState(1.5);
            const [lastMistake, setLastMistake] = useState(false);
            const gameLoopRef = useRef();

            // Quiz Logic
            const [quizIndex, setQuizIndex] = useState(0);
            const [quizScore, setQuizScore] = useState(0);
            const [quizFeedback, setQuizFeedback] = useState(null);
            const [quizFinished, setQuizFinished] = useState(false);

            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            }, [activeTab, gameState, quizFeedback, quizFinished]);

            const spawnWord = useCallback(() => {
                const randomWord = words[Math.floor(Math.random() * words.length)];
                setFallingWord({ ...randomWord, id: Date.now() });
                setFallingPos(0);
            }, []);

            const startGame = () => {
                setScore(0);
                setLives(3);
                setSpeed(1.5);
                setGameState('playing');
                setLastMistake(false);
                spawnWord();
            };

            const startQuiz = () => {
                setQuizIndex(0);
                setQuizScore(0);
                setQuizFeedback(null);
                setQuizFinished(false);
            };

            const loseLife = useCallback(() => {
                setLives(prev => {
                    const next = prev - 1;
                    if (next <= 0) {
                        setGameState('finished');
                        return 0;
                    }
                    return next;
                });
                setLastMistake(true);
                setTimeout(() => setLastMistake(false), 300);
                spawnWord();
            }, [spawnWord]);

            useEffect(() => {
                if (gameState === 'playing' && activeTab === 'game') {
                    gameLoopRef.current = setInterval(() => {
                        setFallingPos(prev => {
                            if (prev >= 90) {
                                loseLife();
                                return 0;
                            }
                            return prev + speed;
                        });
                    }, 50);
                } else {
                    clearInterval(gameLoopRef.current);
                }
                return () => clearInterval(gameLoopRef.current);
            }, [gameState, speed, loseLife, activeTab]);

            const handleChoice = (choice) => {
                if (gameState !== 'playing' || !fallingWord) return;
                if (fallingWord.type === choice) {
                    setScore(s => s + 10);
                    if ((score + 10) % 50 === 0) setSpeed(p => Math.min(p + 0.3, 5));
                    spawnWord();
                } else {
                    loseLife();
                }
            };

            const handleQuizAnswer = (option) => {
                if (quizFeedback) return;
                const isCorrect = option === quizQuestions[quizIndex].correct;
                setQuizFeedback(isCorrect ? 'correct' : 'wrong');
                if (isCorrect) setQuizScore(s => s + 1);
            };

            return (
                <div className="min-h-screen p-4 md:p-8 flex items-center justify-center">
                    <div className="w-full max-w-4xl bg-slate-900 rounded-3xl shadow-2xl border border-slate-800 overflow-hidden flex flex-col">
                        
                        {/* Header */}
                        <header className="bg-gradient-to-r from-indigo-700 to-purple-800 p-6 text-center">
                            <h1 className="text-3xl font-black text-white italic uppercase tracking-tighter">Grammar Dash 3.0</h1>
                            <p className="text-indigo-200 text-sm opacity-80">Master Countable & Uncountable Nouns</p>
                        </header>

                        {/* Nav */}
                        <nav className="flex bg-slate-900 border-b border-slate-800">
                            {['theory', 'game', 'quiz'].map(tab => (
                                <button 
                                    key={tab}
                                    onClick={() => setActiveTab(tab)}
                                    className={`flex-1 py-4 font-bold transition-all uppercase text-sm tracking-widest ${activeTab === tab ? 'text-indigo-400 border-b-4 border-indigo-500 bg-slate-800/50' : 'text-slate-500 hover:text-slate-300'}`}
                                >
                                    {tab === 'theory' ? 'Teorie' : tab === 'game' ? 'Hra' : 'Kv√≠z'}
                                </button>
                            ))}
                        </nav>

                        <main className="p-6 flex-1 min-h-[500px] flex flex-col justify-center">
                            
                            {activeTab === 'theory' && (
                                <div className="space-y-6 max-w-2xl mx-auto w-full">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div className="bg-blue-900/20 border border-blue-500/30 p-5 rounded-2xl">
                                            <h3 className="text-blue-400 font-bold text-xl mb-2">Countable</h3>
                                            <p className="text-sm text-slate-300">Vƒõci, kter√© lze poƒç√≠tat. Maj√≠ jednotn√© i mno≈æn√© ƒç√≠slo. Pou≈æ√≠v√°me <b>a/an, many, a few</b>.</p>
                                            <div className="mt-4 text-3xl">üçé üöó üìñ</div>
                                        </div>
                                        <div className="bg-amber-900/20 border border-amber-500/30 p-5 rounded-2xl">
                                            <h3 className="text-amber-400 font-bold text-xl mb-2">Uncountable</h3>
                                            <p className="text-sm text-slate-300">L√°tky, tekutiny, pocity. Nemaj√≠ mno≈æn√© ƒç√≠slo. Pou≈æ√≠v√°me <b>some, much, a little</b>.</p>
                                            <div className="mt-4 text-3xl">üíß üí∞ üçö</div>
                                        </div>
                                    </div>
                                    <button onClick={() => setActiveTab('quiz')} className="w-full bg-indigo-600 py-4 rounded-xl font-black text-white hover:bg-indigo-500 transition-all uppercase">Spustit kv√≠z</button>
                                </div>
                            )}

                            {activeTab === 'game' && (
                                <div className="w-full flex flex-col items-center">
                                    <div className="w-full flex justify-between mb-4">
                                        <div className="bg-slate-800 px-4 py-2 rounded-xl border border-slate-700 font-black text-yellow-500 italic">SCORE: {score}</div>
                                        <div className="flex gap-1">
                                            {[...Array(3)].map((_, i) => (
                                                <span key={i} className={`text-2xl transition-opacity ${i < lives ? 'opacity-100' : 'opacity-20'}`}>‚ù§Ô∏è</span>
                                            ))}
                                        </div>
                                    </div>
                                    
                                    <div className="relative w-full h-[350px] bg-slate-950 rounded-2xl border-2 border-slate-800 overflow-hidden">
                                        {gameState === 'idle' && (
                                            <div className="absolute inset-0 flex flex-col items-center justify-center bg-slate-900/80 z-10">
                                                <h2 className="text-2xl font-black mb-4">P≈òIPRAVEN?</h2>
                                                <button onClick={startGame} className="bg-indigo-600 px-10 py-3 rounded-xl font-bold hover:bg-indigo-500 transition-all">START</button>
                                            </div>
                                        )}
                                        {gameState === 'finished' && (
                                            <div className="absolute inset-0 flex flex-col items-center justify-center bg-red-950/90 z-20">
                                                <h2 className="text-4xl font-black mb-2">KONEC HRY</h2>
                                                <p className="text-2xl mb-6">Sk√≥re: {score}</p>
                                                <button onClick={startGame} className="bg-white text-black px-10 py-3 rounded-xl font-bold">ZNOVU</button>
                                            </div>
                                        )}
                                        {gameState === 'playing' && fallingWord && (
                                            <div className="absolute left-0 right-0 flex justify-center transition-all ease-linear" style={{ top: `${fallingPos}%` }}>
                                                <div className={`bg-white text-black px-6 py-3 rounded-xl font-black shadow-xl flex items-center gap-2 ${lastMistake ? 'animate-shake' : ''}`}>
                                                    <span>{fallingWord.icon}</span>
                                                    <span>{fallingWord.word}</span>
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    <div className="grid grid-cols-2 gap-4 w-full mt-6">
                                        <button onClick={() => handleChoice('countable')} className="bg-blue-600 py-5 rounded-2xl font-black text-white border-b-4 border-blue-800 active:border-b-0 active:translate-y-1">COUNTABLE</button>
                                        <button onClick={() => handleChoice('uncountable')} className="bg-amber-600 py-5 rounded-2xl font-black text-white border-b-4 border-amber-800 active:border-b-0 active:translate-y-1">UNCOUNTABLE</button>
                                    </div>
                                </div>
                            )}

                            {activeTab === 'quiz' && (
                                <div className="w-full max-w-xl mx-auto">
                                    {!quizFinished ? (
                                        <>
                                            <div className="mb-6 text-center">
                                                <span className="text-xs font-bold text-slate-500 uppercase">Ot√°zka {quizIndex + 1} / {quizQuestions.length}</span>
                                                <h2 className="text-xl font-bold mt-2 italic">
                                                    {quizQuestions[quizIndex].sentence.replace('___', '______')}
                                                </h2>
                                            </div>
                                            <div className="grid grid-cols-1 gap-3">
                                                {quizQuestions[quizIndex].options.map(opt => (
                                                    <button 
                                                        key={opt}
                                                        onClick={() => handleQuizAnswer(opt)}
                                                        disabled={!!quizFeedback}
                                                        className={`py-4 rounded-xl font-bold border-2 transition-all ${quizFeedback ? (opt === quizQuestions[quizIndex].correct ? 'bg-green-600 border-green-400 text-white' : 'bg-slate-800 border-slate-700 text-slate-500') : 'bg-slate-800 border-slate-700 hover:border-indigo-500'}`}
                                                    >
                                                        {opt.toUpperCase()}
                                                    </button>
                                                ))}
                                            </div>
                                            {quizFeedback && (
                                                <div className={`mt-6 p-4 rounded-xl border ${quizFeedback === 'correct' ? 'bg-green-900/20 border-green-500 text-green-200' : 'bg-red-900/20 border-red-500 text-red-200'}`}>
                                                    <p className="font-bold uppercase text-xs mb-1">{quizFeedback === 'correct' ? 'Spr√°vnƒõ!' : 'Chyba!'}</p>
                                                    <p className="text-sm mb-4">{quizQuestions[quizIndex].explanation}</p>
                                                    <button onClick={() => {
                                                        if (quizIndex < quizQuestions.length - 1) {
                                                            setQuizIndex(quizIndex + 1);
                                                            setQuizFeedback(null);
                                                        } else {
                                                            setQuizFinished(true);
                                                        }
                                                    }} className="bg-white/10 px-4 py-2 rounded-lg text-xs font-bold hover:bg-white/20">POKRAƒåOVAT</button>
                                                </div>
                                            )}
                                        </>
                                    ) : (
                                        <div className="text-center">
                                            <h2 className="text-3xl font-black mb-2 uppercase">Kv√≠z hotov!</h2>
                                            <p className="text-indigo-400 text-5xl font-black mb-8">{quizScore} / {quizQuestions.length}</p>
                                            <button onClick={startQuiz} className="bg-indigo-600 px-8 py-3 rounded-xl font-bold">ZKUSIT ZNOVU</button>
                                        </div>
                                    )}
                                </div>
                            )}
                        </main>

                        <footer className="p-4 bg-slate-950 text-center text-[10px] text-slate-600 font-mono tracking-widest uppercase border-t border-slate-800">
                            v4.0 Final Stable // No dependencies required
                        </footer>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>